<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Chess</title>
	<style>
		body{margin:0;padding:0}
		table{margin: auto;margin-top: 50vh;transform: translateY(-50%)}
		td{width:60px;height:60px;border:2px solid}
		.black{background:#433}
		.white{background:#FB1}
		.select{border-color:red}
		#pionB{background-image: url('pionB.png'); background-size: 100% 100%}
		#pionW{background-image: url('pionW.png'); background-size: 100% 100%}
	</style>
</head>
<body>
	<script>
		const chess = 
		{ 
			init : function(row, col)
			{	
				this.row = row
				this.col = col
				this.body = document.body
				this.tabHTML = document.createElement('table')
				this.tabJS = []
				this.tmp
				
				for(let i = this.row-1; i >= 0; i--)
				{
					const tr = document.createElement('tr')
					this.tabJS[i] = []
					for(let j = 0; j < this.col; j++)
					{
						const td = document.createElement('td')
						td.dataset.row = i
						td.dataset.column = j
						if((i+1) % 2 == 0)
						{
							if((j+1) % 2 == 0)
								td.classList.add('black')
							else
								td.classList.add('white')
						}
						else
						{
							if((j+1) % 2 != 0)
								td.classList.add('black')
							else
								td.classList.add('white')		
						}
						
						if(i == 1 )
						{
							td.id = 'pionB'
						}
						if(i == this.row - 2)
						{
							td.id = 'pionW'
						}
						
						td.addEventListener('click', function()
						{
							if(chess.tmp != undefined)
							{
								chess.tmp.classList.remove('select')
								if(chess.tmp.id)
								{
									chess.deplace(chess.tmp, this)
									chess.tmp = undefined
									return
								}
							}
							this.classList.add('select')
							chess.tmp = this
						})
						this.tabJS[i][j] = td
						tr.appendChild(td)
					}
					this.tabHTML.appendChild(tr)
				}
				this.body.appendChild(this.tabHTML)
			},
			
			deplace : function(oldPos, newPos)
			{
				const piece = ['pionB','pionW']
				if(piece.includes(oldPos.id))
				{
					switch(oldPos.id)
					{
						case 'pionB' : 
						{
							if((Number(newPos.getAttribute('data-row')) - 1 == Number(oldPos.getAttribute('data-row'))
							&& ((newPos.getAttribute('data-column') == oldPos.getAttribute('data-column') && newPos.id == '' )
								 || (newPos.getAttribute('data-column') != oldPos.getAttribute('data-column') && newPos.id !='')))
								|| (Number(newPos.getAttribute('data-row')) - 2 == Number(oldPos.getAttribute('data-row')) && 
									 (Number(oldPos.getAttribute('data-row') == 1)) && (newPos.getAttribute('data-column') == oldPos.getAttribute('data-column'))))
							{	
								newPos.id = oldPos.id
								oldPos.id = ''
							}
							break;
						}
						case 'pionW' : 
						{
							if((Number(newPos.getAttribute('data-row')) + 1 == Number(oldPos.getAttribute('data-row'))
							&& ((newPos.getAttribute('data-column') == oldPos.getAttribute('data-column') && newPos.id == '' )
								 || (newPos.getAttribute('data-column') != oldPos.getAttribute('data-column') && newPos.id !='')))
								|| (Number(newPos.getAttribute('data-row')) + 2 == Number(oldPos.getAttribute('data-row')) && 
									 (Number(oldPos.getAttribute('data-row') == this.row - 2)) && (newPos.getAttribute('data-column') == oldPos.getAttribute('data-column'))))
							{	
								newPos.id = oldPos.id
								oldPos.id = ''
							}
							break;
						}
							
					}

				}
			}
		}
		
		chess.init(8,8)
	</script>
</body>
</html>